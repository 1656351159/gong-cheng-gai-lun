CREATE TABLE sys_user (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR(64) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(32) NOT NULL,
    email VARCHAR(128),
    phone VARCHAR(32),
    enabled BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP
);

CREATE TABLE material_category (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    parent_id BIGINT,
    name VARCHAR(128) NOT NULL,
    safe_stock INTEGER DEFAULT 0,
    unit VARCHAR(32),
    created_at TIMESTAMP
);

CREATE TABLE material_item (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    category_id BIGINT,
    brand VARCHAR(128),
    model VARCHAR(128),
    spec VARCHAR(256),
    unit_price DECIMAL(12,2),
    currency VARCHAR(8),
    extra VARCHAR(1024),
    created_at TIMESTAMP
);

CREATE TABLE stock_batch (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    item_id BIGINT,
    batch_code VARCHAR(64) UNIQUE NOT NULL,
    quantity INTEGER NOT NULL,
    expire_date DATE,
    barcode VARCHAR(128),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE stock_transaction (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    batch_id BIGINT,
    txn_type VARCHAR(16),
    qty INTEGER,
    user_id BIGINT,
    project_no VARCHAR(64),
    usage VARCHAR(128),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE request (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    item_id BIGINT,
    qty INTEGER,
    purpose VARCHAR(255),
    project_no VARCHAR(64),
    status VARCHAR(16),
    comment VARCHAR(255),
    student_id BIGINT,
    reviewer_id BIGINT,
    reviewed_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
